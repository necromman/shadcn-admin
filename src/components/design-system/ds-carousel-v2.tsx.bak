'use client'

import { useState, useEffect, useCallback, useMemo } from 'react'
import {
  Carousel,
  CarouselContent,
  CarouselItem,
  CarouselNext,
  CarouselPrevious,
  type CarouselApi,
} from '@/components/ui/carousel'
import { Button } from '@/components/ui/button'
import { Badge } from '@/components/ui/badge'
import { Checkbox } from '@/components/ui/checkbox'
import { Label } from '@/components/ui/label'
import { Input } from '@/components/ui/input'
import { cn } from '@/lib/utils'
import { HiArrowRight, HiPlay, HiPause, HiCog6Tooth } from 'react-icons/hi2'

interface CarouselSlide {
  id: string
  title: string
  subtitle?: string
  description?: string
  cta?: {
    text: string
    link: string
    variant?: 'default' | 'outline' | 'secondary' | 'ghost'
  }
  secondaryCta?: {
    text: string
    link: string
    variant?: 'default' | 'outline' | 'secondary' | 'ghost'
  }
  badge?: string
  alignment?: 'left' | 'center' | 'right'
  bgColor?: string
}

interface CarouselOptions {
  height: number
  indicatorStyle: 'circle' | 'square'
  indicatorPosition: 'inside' | 'outside'
  autoPlay: boolean
  navigationSize: 'small' | 'medium' | 'large' | 'custom'
  customButtonSize: number
  customIconSize: number
  navigationPosition: 'safe' | 'edge'  // safe: 안전영역, edge: 좌우 끝
}

// 엔터프라이즈 슬라이드 데이터
const SAMPLE_SLIDES: CarouselSlide[] = [
  {
    id: 'slide-1',
    title: '차세대 클라우드 네이티브 플랫폼',
    subtitle: 'Digital Transformation',
    description: '마이크로서비스 아키텍처와 컨테이너 오케스트레이션을 기반으로 확장 가능한 인프라를 구축합니다. 자동화된 CI/CD 파이프라인으로 배포 속도를 개선하고, 멀티 클라우드 환경에서 유연한 워크로드 관리를 실현합니다.',
    alignment: 'left',
    bgColor: 'bg-[#151515]',
    cta: {
      text: '솔루션 보기',
      link: '#',
      variant: 'default'
    },
    secondaryCta: {
      text: '문의하기',
      link: '#',
      variant: 'outline'
    }
  },
  {
    id: 'slide-2',
    title: '엔터프라이즈 보안 플랫폼',
    subtitle: 'Zero Trust Security',
    description: '제로 트러스트 아키텍처로 모든 접근을 검증하고 실시간 모니터링합니다. AI 기반 위협 탐지와 자동화된 대응 시스템으로 엔드포인트부터 클라우드까지 통합 보안을 제공합니다.',
    alignment: 'left',
    bgColor: 'bg-[#151515]',
    cta: {
      text: '보안 평가',
      link: '#',
      variant: 'default'
    },
    secondaryCta: {
      text: '자료 받기',
      link: '#',
      variant: 'outline'
    }
  },
  {
    id: 'slide-3',
    title: '데이터 인텔리전스 플랫폼',
    subtitle: 'Business Intelligence',
    description: '실시간 데이터 분석과 머신러닝을 통해 비즈니스 인사이트를 제공합니다. 직관적인 대시보드와 자동화된 리포팅으로 데이터 기반 의사결정을 지원합니다.',
    alignment: 'left',
    bgColor: 'bg-[#151515]',
    cta: {
      text: '무료 체험',
      link: '#',
      variant: 'secondary'
    },
    secondaryCta: {
      text: '데모 보기',
      link: '#',
      variant: 'outline'
    }
  }
]

export function DSCarousel() {
  const [api, setApi] = useState<CarouselApi>()
  const [current, setCurrent] = useState(0)
  const [isPaused, setIsPaused] = useState(false)
  const [options, setOptions] = useState<CarouselOptions>({
    height: 400,  // 기본값
    indicatorStyle: 'square',  // 사각형
    indicatorPosition: 'inside',  // 내부
    autoPlay: true,  // 자동재생
    navigationSize: 'large',  // 크게를 기본값으로 변경
    customButtonSize: 64,  // 커스텀 버튼 크기
    customIconSize: 32,  // 커스텀 아이콘 크기
    navigationPosition: 'safe'  // 컨테이너 내부
  })
  
  // PC 최소/최대 높이 제약
  const MIN_HEIGHT_PC = 300
  const MAX_HEIGHT = 800
  const INDICATOR_HEIGHT = 50
  
  // 실제 적용 높이 계산
  const appliedHeight = Math.max(MIN_HEIGHT_PC, Math.min(options.height, MAX_HEIGHT))
  
  // 컨텐츠 영역 실제 높이 계산
  const contentAreaHeight = options.indicatorPosition === 'inside' 
    ? appliedHeight - INDICATOR_HEIGHT 
    : appliedHeight
  
  // 네비게이션 버튼 크기 스타일
  const getNavigationSizeStyle = () => {
    if (options.navigationSize === 'custom') {
      return {
        width: `${options.customButtonSize}px`,
        height: `${options.customButtonSize}px`
      }
    }
    
    const sizes = {
      small: 40,
      medium: 48,
      large: 64
    }
    
    const size = sizes[options.navigationSize] || 56
    return {
      width: `${size}px`,
      height: `${size}px`
    }
  }
  
  // 네비게이션 아이콘 크기
  const getNavigationIconSize = () => {
    if (options.navigationSize === 'custom') {
      return options.customIconSize
    }
    
    switch(options.navigationSize) {
      case 'small':
        return 20
      case 'medium':
        return 24
      case 'large':
        return 32
      default:
        return 28
    }
  }
  
  // 높이에 따른 동적 스타일 계산 (개선된 버전)
  const dynamicStyles = useMemo(() => {
    const height = appliedHeight
    
    // 높이 구간별 스타일 정의
    const getStyles = () => {
      if (height <= 350) {
        return {
          titleSize: 'text-2xl md:text-3xl lg:text-4xl',
          subtitleSize: 'text-xs md:text-sm',
          descriptionSize: 'text-sm md:text-base line-clamp-2',
          buttonSize: 'default',
          buttonHeight: 'h-9',
          contentSpacing: 'space-y-2 md:space-y-3',
          ctaPadding: 'pt-3',
        }
      } else if (height <= 450) {
        return {
          titleSize: 'text-3xl md:text-4xl lg:text-5xl',
          subtitleSize: 'text-sm md:text-base',
          descriptionSize: 'text-base md:text-lg line-clamp-3',
          buttonSize: 'default',
          buttonHeight: 'h-10',
          contentSpacing: 'space-y-3 md:space-y-4',
          ctaPadding: 'pt-4',
        }
      } else if (height <= 550) {
        return {
          titleSize: 'text-4xl md:text-5xl lg:text-6xl',
          subtitleSize: 'text-base md:text-lg',
          descriptionSize: 'text-lg md:text-xl',
          buttonSize: 'lg',
          buttonHeight: 'h-11',
          contentSpacing: 'space-y-4 md:space-y-5',
          ctaPadding: 'pt-5',
        }
      } else {
        return {
          titleSize: 'text-5xl md:text-6xl lg:text-7xl',
          subtitleSize: 'text-lg md:text-xl',
          descriptionSize: 'text-xl md:text-2xl',
          buttonSize: 'lg',
          buttonHeight: 'h-12',
          contentSpacing: 'space-y-5 md:space-y-6',
          ctaPadding: 'pt-6',
        }
      }
    }
    
    const styles = getStyles()
    
    // 버튼 크기 계산
    const getButtonSize = () => {
      const sizes = {
        small: 40,
        medium: 48,
        large: 64,
        custom: options.customButtonSize
      }
      return sizes[options.navigationSize] || 64
    }
    
    const buttonSize = getButtonSize()
    const buttonSpacing = 20 // 버튼과 컨텐츠 간격
    
    // 컨텐츠 패딩 계산 - 버튼 크기에 따른 좌우 패딩
    const contentPadding = {
      horizontal: buttonSize + buttonSpacing,
      vertical: Math.max(24, Math.min(height * 0.08, 60))
    }
    
    return {
      ...styles,
      buttonSize,
      contentPadding,
      verticalPadding: contentPadding.vertical,
      horizontalPadding: contentPadding.horizontal,
      maxWidth: 'w-full'
    }
  }, [appliedHeight, options.navigationSize, options.customButtonSize])
  
  // 인디케이터 스타일 클래스
  const getIndicatorClass = (isActive: boolean) => {
    const baseClass = 'transition-all duration-300'
    
    // 스타일별 크기 설정
    const sizeClass = options.indicatorStyle === 'square' 
      ? (isActive ? 'w-8 h-2' : 'w-4 h-2')  // 사각형: 가로로 긴 모양
      : (isActive ? 'w-8 h-2' : 'w-2 h-2')  // 원형: 작은 원에서 타원으로
    
    // 모양 설정 (원형 vs 사각형)
    const shapeClass = options.indicatorStyle === 'square' 
      ? 'rounded-[2px]'  // 사각형: 매우 작은 radius로 거의 직사각형
      : 'rounded-full'  // 원형: 완전한 원
    
    // 내부 배치일 때 더 눈에 띄는 스타일
    if (options.indicatorPosition === 'inside') {
      const colorClass = isActive 
        ? 'bg-white border border-white/50' 
        : 'bg-white/50 hover:bg-white/70 border border-white/30'
      return cn(baseClass, sizeClass, shapeClass, colorClass)
    }
    
    // 외부 배치일 때 기본 스타일
    const colorClass = isActive 
      ? 'bg-primary' 
      : 'bg-muted-foreground/30 hover:bg-muted-foreground/50'
    return cn(baseClass, sizeClass, shapeClass, colorClass)
  }

  // 현재 슬라이드 업데이트
  useEffect(() => {
    if (!api) return

    setCurrent(api.selectedScrollSnap())

    api.on('select', () => {
      setCurrent(api.selectedScrollSnap())
    })
  }, [api])

  // 자동 재생
  useEffect(() => {
    if (!api || !options.autoPlay || isPaused) return

    const interval = setInterval(() => {
      api.scrollNext()
    }, 5000)

    return () => clearInterval(interval)
  }, [api, options.autoPlay, isPaused, current])

  // 슬라이드 직접 이동
  const scrollTo = useCallback((index: number) => {
    api?.scrollTo(index)
  }, [api])

  // 마우스 hover 시 일시정지
  const handleMouseEnter = () => setIsPaused(true)
  const handleMouseLeave = () => setIsPaused(false)

  return (
    <div className="w-full">
      {/* 콘텐츠 표시 옵션 패널 - 캐러셀 위에 위치 */}
      <div className="container mb-6">
        <div className="bg-slate-100 dark:bg-muted/30 border-2 border-dotted border-slate-300 dark:border-border/50 rounded-lg p-4">
          <div className="flex items-center gap-2 mb-3">
            <HiCog6Tooth className="h-4 w-4 text-slate-600 dark:text-muted-foreground" />
            <span className="text-sm font-semibold text-slate-700 dark:text-muted-foreground">캐러셀 표시 옵션</span>
          </div>
          
          <div className="space-y-4">
            {/* 높이 조절 (PC 최소 높이 300px 적용) */}
            <div className="flex flex-col sm:flex-row sm:items-center gap-3">
              <Label className="text-sm text-slate-600 dark:text-slate-400 sm:min-w-[80px]">캐러셀 높이:</Label>
              <div className="flex flex-wrap items-center gap-2">
                <div className="flex items-center gap-2">
                  <Input
                    type="number"
                    min={MIN_HEIGHT_PC}
                    max={MAX_HEIGHT}
                    step="50"
                    value={options.height}
                    onChange={(e) => {
                      const value = parseInt(e.target.value) || 400
                      setOptions(prev => ({ ...prev, height: value }))
                    }}
                    className="w-24 h-8"
                  />
                  <span className="text-sm text-slate-500">px</span>
                  {options.height < MIN_HEIGHT_PC && (
                    <span className="text-xs text-amber-600">최소 {MIN_HEIGHT_PC}px</span>
                  )}
                </div>
                <div className="flex gap-2">
                  <Button
                    size="sm"
                    variant={options.height === 300 ? 'default' : 'outline'}
                    onClick={() => setOptions(prev => ({ ...prev, height: 300 }))}
                    className="h-8 px-2 sm:px-3 text-xs sm:text-sm"
                  >
                    작게
                  </Button>
                  <Button
                    size="sm"
                    variant={options.height === 400 ? 'default' : 'outline'}
                    onClick={() => setOptions(prev => ({ ...prev, height: 400 }))}
                    className="h-8 px-2 sm:px-3 text-xs sm:text-sm"
                  >
                    기본
                  </Button>
                  <Button
                    size="sm"
                    variant={options.height === 600 ? 'default' : 'outline'}
                    onClick={() => setOptions(prev => ({ ...prev, height: 600 }))}
                    className="h-8 px-2 sm:px-3 text-xs sm:text-sm"
                  >
                    크게
                  </Button>
                </div>
              </div>
            </div>
            
            {/* 인디케이터 설정 */}
            <div className="flex flex-col sm:flex-row flex-wrap gap-4 sm:gap-6">
              {/* 인디케이터 스타일 */}
              <div className="flex items-center gap-2 sm:gap-3">
                <span className="text-sm text-slate-600 dark:text-slate-400 whitespace-nowrap">스타일:</span>
                <div className="flex gap-1 sm:gap-2">
                  <Button
                    size="sm"
                    variant={options.indicatorStyle === 'circle' ? 'default' : 'outline'}
                    onClick={() => setOptions(prev => ({ ...prev, indicatorStyle: 'circle' }))}
                    className="h-8 px-2 sm:px-3 text-xs sm:text-sm"
                  >
                    <span className="inline-block w-2 h-2 rounded-full bg-current mr-1.5"></span>
                    원형
                  </Button>
                  <Button
                    size="sm"
                    variant={options.indicatorStyle === 'square' ? 'default' : 'outline'}
                    onClick={() => setOptions(prev => ({ ...prev, indicatorStyle: 'square' }))}
                    className="h-8 px-2 sm:px-3 text-xs sm:text-sm"
                  >
                    <span className="inline-block w-2 h-2 rounded-[1px] bg-current mr-1.5"></span>
                    사각형
                  </Button>
                </div>
              </div>
              
              {/* 인디케이터 위치 */}
              <div className="flex items-center gap-2 sm:gap-3">
                <span className="text-sm text-slate-600 dark:text-slate-400 whitespace-nowrap">위치:</span>
                <div className="flex gap-1 sm:gap-2">
                  <Button
                    size="sm"
                    variant={options.indicatorPosition === 'outside' ? 'default' : 'outline'}
                    onClick={() => setOptions(prev => ({ ...prev, indicatorPosition: 'outside' }))}
                    className="h-8 px-2 sm:px-3 text-xs sm:text-sm"
                  >
                    외부
                  </Button>
                  <Button
                    size="sm"
                    variant={options.indicatorPosition === 'inside' ? 'default' : 'outline'}
                    onClick={() => setOptions(prev => ({ ...prev, indicatorPosition: 'inside' }))}
                    className="h-8 px-2 sm:px-3 text-xs sm:text-sm"
                  >
                    내부
                  </Button>
                </div>
              </div>
              
              {/* 자동 재생 */}
              <div className="flex items-center space-x-2">
                <Checkbox 
                  id="autoplay" 
                  checked={options.autoPlay}
                  onCheckedChange={(checked) => setOptions(prev => ({ ...prev, autoPlay: checked as boolean }))}
                  className="h-4 w-4 border-slate-400 dark:border-border"
                />
                <Label htmlFor="autoplay" className="cursor-pointer text-sm font-normal text-slate-700 dark:text-slate-300 whitespace-nowrap">
                  자동 재생
                </Label>
              </div>
            </div>
            
            {/* 네비게이션 버튼 크기 */}
            <div className="space-y-3">
              <div className="flex flex-col sm:flex-row sm:items-center gap-3">
                <Label className="text-sm text-slate-600 dark:text-slate-400 sm:min-w-[80px]">버튼 크기:</Label>
                <div className="flex flex-wrap items-center gap-2">
                  <div className="flex gap-2">
                    <Button
                      size="sm"
                      variant={options.navigationSize === 'small' ? 'default' : 'outline'}
                      onClick={() => setOptions(prev => ({ ...prev, navigationSize: 'small' }))}
                      className="h-8 px-2 sm:px-3 text-xs sm:text-sm"
                    >
                      작게
                    </Button>
                    <Button
                      size="sm"
                      variant={options.navigationSize === 'medium' ? 'default' : 'outline'}
                      onClick={() => setOptions(prev => ({ ...prev, navigationSize: 'medium' }))}
                      className="h-8 px-2 sm:px-3 text-xs sm:text-sm"
                    >
                      보통
                    </Button>
                    <Button
                      size="sm"
                      variant={options.navigationSize === 'large' ? 'default' : 'outline'}
                      onClick={() => setOptions(prev => ({ ...prev, navigationSize: 'large' }))}
                      className="h-8 px-2 sm:px-3 text-xs sm:text-sm"
                    >
                      크게
                    </Button>
                    <Button
                      size="sm"
                      variant={options.navigationSize === 'custom' ? 'default' : 'outline'}
                      onClick={() => setOptions(prev => ({ ...prev, navigationSize: 'custom' }))}
                      className="h-8 px-2 sm:px-3 text-xs sm:text-sm"
                    >
                      커스텀
                    </Button>
                  </div>
                </div>
              </div>
              
              {/* 커스텀 크기 입력 */}
              {options.navigationSize === 'custom' && (
                <div className="flex flex-col sm:flex-row gap-3 pl-0 sm:pl-[88px]">
                  <div className="flex items-center gap-2">
                    <Label className="text-xs text-slate-500 whitespace-nowrap">버튼:</Label>
                    <Input
                      type="number"
                      min="30"
                      max="100"
                      value={options.customButtonSize}
                      onChange={(e) => setOptions(prev => ({ ...prev, customButtonSize: parseInt(e.target.value) || 48 }))}
                      className="w-20 h-8"
                    />
                    <span className="text-xs text-slate-500">px</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <Label className="text-xs text-slate-500 whitespace-nowrap">아이콘:</Label>
                    <Input
                      type="number"
                      min="16"
                      max="64"
                      value={options.customIconSize}
                      onChange={(e) => setOptions(prev => ({ ...prev, customIconSize: parseInt(e.target.value) || 24 }))}
                      className="w-20 h-8"
                    />
                    <span className="text-xs text-slate-500">px</span>
                  </div>
                </div>
              )}
            </div>
            
            {/* 네비게이션 버튼 위치 */}
            <div className="flex items-center gap-2 sm:gap-3">
              <span className="text-sm text-slate-600 dark:text-slate-400 whitespace-nowrap">버튼 위치:</span>
              <div className="flex gap-1 sm:gap-2">
                <Button
                  size="sm"
                  variant={options.navigationPosition === 'safe' ? 'default' : 'outline'}
                  onClick={() => setOptions(prev => ({ ...prev, navigationPosition: 'safe' }))}
                  className="h-8 px-2 sm:px-3 text-xs sm:text-sm"
                >
                  컨텐츠 내부
                </Button>
                <Button
                  size="sm"
                  variant={options.navigationPosition === 'edge' ? 'default' : 'outline'}
                  onClick={() => setOptions(prev => ({ ...prev, navigationPosition: 'edge' }))}
                  className="h-8 px-2 sm:px-3 text-xs sm:text-sm"
                >
                  캐러셀 가장자리
                </Button>
              </div>
              <span className="text-xs text-slate-500 ml-2">(데스크톱만 적용)</span>
            </div>
          </div>
          
          <p className="text-xs text-slate-500 dark:text-muted-foreground mt-3 pl-0.5">
            캐러셀의 표시 방식을 사용자화할 수 있습니다
          </p>
        </div>
      </div>
      
      {/* 캐러셀 본체 */}
      <div 
        onMouseEnter={handleMouseEnter}
        onMouseLeave={handleMouseLeave}
        className={cn(
          "relative",
          options.indicatorPosition === 'outside' && "mb-4"  // 인디케이터가 외부일 때 하단 여백
        )}
      >
        {/* 인디케이터가 내부일 때 전체 높이 조정 */}
        <div 
          className="relative overflow-hidden bg-[#151515]"
          style={{ height: `${options.height}px` }}
        >
          <Carousel
            setApi={setApi}
            className="w-full h-full relative"
            opts={{
              align: 'start',
              loop: true,
            }}
          >
            <CarouselContent 
              className="-ml-0"
              style={{ height: `${options.height}px` }}
            >
              {SAMPLE_SLIDES.map((slide) => {
                return (
                  <CarouselItem key={slide.id} className="pl-0">
                    {/* 슬라이드 컨테이너 */}
                    <div 
                      className={cn(
                        "relative w-full h-full",
                        slide.bgColor || "bg-[#151515]"
                      )}
                    >
                      {/* Container 기준 레이아웃 */}
                      <div className="container mx-auto relative h-full">
                        
                        {/* 콘텐츠 영역 - 버튼 공간만큼 패딩 */}
                        <div 
                          className="flex items-center h-full"
                          style={{
                            height: contentAreaHeight + 'px',
                            paddingTop: dynamicStyles.verticalPadding + 'px',
                            paddingBottom: options.indicatorPosition === 'inside' 
                              ? (dynamicStyles.verticalPadding + 10) + 'px'
                              : dynamicStyles.verticalPadding + 'px',
                            paddingLeft: dynamicStyles.horizontalPadding + 'px',
                            paddingRight: dynamicStyles.horizontalPadding + 'px'
                          }}
                        >
                          <div className={cn(dynamicStyles.maxWidth, dynamicStyles.contentSpacing)}>
                            {/* 배지 */}
                            {slide.badge && (
                              <div className="flex items-center">
                                <Badge 
                                  variant="secondary" 
                                  className="bg-primary/20 text-primary-foreground backdrop-blur-sm border-primary/30 px-5 py-2 text-xs font-bold uppercase tracking-wider"
                                >
                                  {slide.badge}
                                </Badge>
                              </div>
                            )}
                            
                            {/* 부제목 */}
                            {slide.subtitle && (
                              <div className="space-y-2">
                                <p className={cn(
                                  dynamicStyles.subtitleSize,
                                  "uppercase tracking-[0.2em] text-slate-400 dark:text-primary/70 font-semibold"
                                )}>
                                  {slide.subtitle}
                                </p>
                                <div className="h-0.5 w-16 bg-slate-400 dark:bg-primary/50" />
                              </div>
                            )}
                            
                            {/* 제목 */}
                            <h2 className={cn(
                              dynamicStyles.titleSize,
                              "font-bold text-white leading-tight"
                            )}>
                              {slide.title}
                            </h2>
                            
                            {/* 설명 */}
                            {slide.description && (
                              <p className={cn(
                                dynamicStyles.descriptionSize,
                                "text-slate-300 leading-relaxed",
                                options.height <= 300 ? "max-w-3xl" : "max-w-4xl"
                              )}>
                                {slide.description}
                              </p>
                            )}
                            
                            {/* CTA 버튼들 */}
                            {(slide.cta || slide.secondaryCta) && (
                              <div className={cn("flex flex-col sm:flex-row gap-4", dynamicStyles.ctaPadding)}>
                                {slide.cta && (
                                  <Button
                                    variant={slide.cta.variant || 'default'}
                                    size={dynamicStyles.buttonSize as 'default' | 'lg'}
                                    className={cn(
                                      "group min-w-[180px] text-base",
                                      dynamicStyles.buttonHeight
                                    )}
                                    onClick={() => window.location.href = slide.cta?.link || '#'}
                                  >
                                    {slide.cta.text}
                                    <HiArrowRight className="ml-2 h-5 w-5 transition-transform group-hover:translate-x-1" />
                                  </Button>
                                )}
                                {slide.secondaryCta && (
                                  <Button
                                    variant="outline"
                                    size={dynamicStyles.buttonSize as 'default' | 'lg'}
                                    className={cn(
                                      "min-w-[180px] text-base bg-white/5 backdrop-blur-sm border-white/20 text-white hover:bg-white/10 hover:border-white/30",
                                      dynamicStyles.buttonHeight
                                    )}
                                    onClick={() => window.location.href = slide.secondaryCta?.link || '#'}
                                  >
                                    {slide.secondaryCta.text}
                                  </Button>
                                )}
                              </div>
                            )}
                          </div>
                        </div>
                      </div>
                    </div>
                  </CarouselItem>
              )
            })}
          </CarouselContent>
          
          {/* 데스크톱 네비게이션 버튼 - 정확한 위치 계산 */}
          <div className="hidden md:block">
            <div 
              className="absolute inset-0 pointer-events-none"
              style={{ 
                height: `${appliedHeight}px`,
                zIndex: 20
              }}
            >
              {/* 좌측 버튼 */}
              <CarouselPrevious 
                className="pointer-events-auto bg-white/10 backdrop-blur-sm border border-white/20 text-white hover:bg-white/20 hover:border-white/30 transition-all absolute"
                style={{
                  ...getNavigationSizeStyle(),
                  top: '50%',
                  transform: 'translateY(-50%)',
                  left: options.navigationPosition === 'safe' 
                    ? `${dynamicStyles.verticalPadding}px`  // 컨텐츠 내부
                    : '16px'  // 캐러셀 가장자리
                }}
                iconSize={getNavigationIconSize()}
              />
              {/* 우측 버튼 */}
              <CarouselNext 
                className="pointer-events-auto bg-white/10 backdrop-blur-sm border border-white/20 text-white hover:bg-white/20 hover:border-white/30 transition-all absolute"
                style={{
                  ...getNavigationSizeStyle(),
                  top: '50%',
                  transform: 'translateY(-50%)',
                  right: options.navigationPosition === 'safe' 
                    ? `${dynamicStyles.verticalPadding}px`  // 컨텐츠 내부
                    : '16px'  // 캐러셀 가장자리
                }}
                iconSize={getNavigationIconSize()}
              />
            </div>
          </div>
          </Carousel>
          
          {/* 인디케이터 영역 - 내부 배치 시 하단에 고정 */}
          {options.indicatorPosition === 'inside' && (
            <div 
              className="absolute bottom-0 left-0 right-0 flex items-center justify-center bg-black/10"
              style={{ height: '50px' }}
            >
              <div className="flex items-center gap-4">
                {/* 자동재생 버튼 */}
                <Button
                  variant="ghost"
                  size="icon"
                  onClick={() => setOptions(prev => ({ ...prev, autoPlay: !prev.autoPlay }))}
                  className="h-8 w-8 bg-black/20 backdrop-blur-sm hover:bg-white/20 hover:text-white text-white border border-white/20"
                  aria-label={options.autoPlay ? '일시정지' : '재생'}
                >
                  {options.autoPlay ? (
                    <HiPause className="h-4 w-4 text-white" />
                  ) : (
                    <HiPlay className="h-4 w-4 text-white" />
                  )}
                </Button>
                
                {/* 인디케이터 (dots) */}
                <div className="flex items-center gap-2">
                  {SAMPLE_SLIDES.map((_, index) => (
                    <button
                      key={index}
                      onClick={() => scrollTo(index)}
                      className={getIndicatorClass(current === index)}
                      aria-label={`Go to slide ${index + 1}`}
                    />
                  ))}
                </div>
              </div>
            </div>
          )}
        </div>
      </div>
      
      {/* 인디케이터와 자동재생 컨트롤 - 외부 배치 */}
      {options.indicatorPosition === 'outside' && (
        <div className="flex items-center justify-center gap-4 mt-4">
          {/* 자동재생 버튼 */}
          <Button
            variant="ghost"
            size="icon"
            onClick={() => setOptions(prev => ({ ...prev, autoPlay: !prev.autoPlay }))}
            className="h-8 w-8 hover:bg-accent hover:text-accent-foreground"
            aria-label={options.autoPlay ? '일시정지' : '재생'}
          >
            {options.autoPlay ? (
              <HiPause className="h-4 w-4" />
            ) : (
              <HiPlay className="h-4 w-4" />
            )}
          </Button>
          
          {/* 인디케이터 (dots) */}
          <div className="flex items-center gap-2">
            {SAMPLE_SLIDES.map((_, index) => (
              <button
                key={index}
                onClick={() => scrollTo(index)}
                className={getIndicatorClass(current === index)}
                aria-label={`Go to slide ${index + 1}`}
              />
            ))}
          </div>
        </div>
      )}
    </div>
  )
}